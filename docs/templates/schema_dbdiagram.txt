Table template {
 id int [pk]
 title varchar
 type template_type
}

Table section {
 id int [pk]
 template_id int [ref: > template.id]
 title varchar
 order int
}

Table puzzle {
 id int [pk]
 section_id int [ref: > section.id]
 parent_id int [ref: > puzzle.id]
 title varchar
 description varchar
 puzzle_type puzzle_type
 order int
}

Table condition {
  id int [pk]
  puzzle_id int [ref: > puzzle.id]
  order int
  question_puzzle int [ref: > puzzle.id]
  action_type condition_action_type
  answer_puzzle int [ref: > puzzle.id]
  value int
  condition_type condition_type
}

Table validation {
  id id [pk]
  puzzle_id int [ref: > puzzle.id]
  order int
  operator_type operator_type
  validation_type validation_action_type
  left_hand_puzzle int [ref: > puzzle.id]
  right_hand_puzzle int [ref: > puzzle.id]
  value int
  error_message varchar
}

enum puzzle_type {
 "group"
 "question"
 "radio_answer"
 "checkbox_answer"
 "dropdown_answer"
 "upload_files"
 "date_answer"
 "text_answer"
 "numeric_answer"
 "reference_answer"
 "reference_text"
 "reference_asset"
}

enum condition_action_type {
 chosen_answer
 given_answer
 equal
 not_equal
 more_than
 less_than
}

enum validation_action_type {
 compare_with_answer
 set_value
}

enum template_type {
  light
  complex
}

enum operator_type {
 less_than
 more_than
 equal
 less_or_equal
 more_or_equal
}

enum condition_type {
  or
  and
}

enum unit_type {
 km
 m
 sm
}

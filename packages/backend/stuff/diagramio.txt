Table templates {
  id int [pk]
  type template_type
  title text
  description text
  created_at timestamp
  updated_at timestamp
}

Table sections {
  id int [pk]
  template_id int [ref: > templates.id]
  title text
  description text
  order int
  created_at timestamp
  updated_at timestamp
}

Table puzzles {
  id int [pk]
  uuid uuid
  template_id int [ref: > templates.id]
  section_id int [ref: > sections.id]
  parent_id int
  title text
  description text
  puzzle_type puzzle_type
  order int
  answer_type input_type
  created_at timestamp
  updated_at timestamp
}

Table conditions {
  id int [pk]
  puzzle_id int [ref: > puzzles.id]
  order int
  question_puzzle uuid [ref: > puzzles.uuid]
  action_type condition_action_type
  answer_puzzle uuid [ref: > puzzles.uuid]
  value int
  condition_type condition_type
  created_at timestamp
  updated_at timestamp
}

Table validations {
  id int [pk]
  puzzle_id int [ref: > puzzles.id]
  order int
  operator_type operator_type
  validation_type validation_action_type
  left_hand_puzzle uuid [ref: > puzzles.id]
  right_hand_puzzle uuid [ref: > puzzles.id]
  value int
  error_message text
  created_at timestamp
  updated_at timestamp
}

enum template_type {
  light
  complex
}

enum puzzle_type {
  question
  numeric_answer
  string_answer
  radio_answer
  input_answer
  group
}

enum condition_action_type {
  chosen_answer
}

enum validation_action_type {
  compare_with_answer
  set_value
}

enum input_type {
  string
  number
}

enum operator_type {
  less
  more
  equal
  less_or_equal
  more_or_equal
}

enum unit_type {
  km
  m
  sm
}

enum condition_type {
  or
  and
}

enum status_type {
  inactive
  inprogress
  oncheck
  overdue
  completed
}

Table tariffs {
  id int [pk]
  name text
  toir_id int
  toir_name text
  toir_type text
  created_at timestamp
  updated_at timestamp
}

Table users {
  id int [pk]
  login text
  name text
  position text
  branch_id int [ref: > branches.id]
  created_at timestamp
  updated_at timestamp
}

Table regions {
  id int [pk]
  name text
  created_at timestamp
  updated_at timestamp
}

Table branches {
  id int [pk]
  name text
  region_id int [ref: > regions.id]
  created_at timestamp
  updated_at timestamp
}

Table objects {
  id int [pk]
  name text
  branch_id int [ref: > branches.id]
  address text
  format text
  created_at timestamp
  updated_at timestamp
}

Table tasks {
  id int [pk]
  name text
  description text
  departure_date timestamp
  deadline_date timestamp
  object_id int [ref: > objects.id]
  user_id int [ref: > users.id]
  status status_type
  created_at timestamp
  updated_at timestamp
}

Table task_templates {
  id int [pk]
  task_id int [ref: > tasks.id]
  template_id int [ref: > templates.id]
  created_at timestamp
  updated_at timestamp
}

Table task_users{
  id int [pk]
  task_id int [ref: > tasks.id]
  users_id int [ref: > users.id]
  taken boolean
  created_at timestamp
  updated_at timestamp
}

Table answers {
  id int [pk]
  puzzle_id int [ref: > puzzles.id]
  answer text
  answer_type input_type
  created_at timestamp
  updated_at timestamp
}

Table notifications {
  id int [pk]
  task_id int [ref: > tasks.id]
  message text
}
(this["webpackJsonp@magnit/frontend"]=this["webpackJsonp@magnit/frontend"]||[]).push([[6],{302:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(136),c=n(9),r=n(289),s=(n(0),function(e){var t=e.children,n=Object(a.a)(e,["children"]);return Object(c.jsx)(r.a,Object.assign({container:!0,direction:"column",css:{width:"100%",minHeight:"100vh"}},n),t)});s.displayName="SectionLayout"},303:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9),c=n(289),r=n(134),s=n(294),i=(n(0),function(e){var t=e.title,n=e.children;return Object(a.jsx)(c.a,{item:!0,css:{height:"var(--section-title-height)",boxShadow:"0 6px 20px rgba(220, 227, 235, 0.3)"}},Object(a.jsx)(r.a,{square:!0,css:{height:"100%",display:"flex",alignItems:"center",boxShadow:"none !important"}},Object(a.jsx)(c.a,{container:!0,css:function(e){return{paddingLeft:e.spacing(4),paddingRight:e.spacing(4)}}},Object(a.jsx)(c.a,{item:!0,xs:!0},Object(a.jsx)(s.a,{variant:"h4",component:"div"},Object(a.jsx)("span",null,t))),n)))});i.displayName="SectionTitle"},304:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(136),c=n(9),r=n(289),s=(n(0),function(e){var t=e.children,n=Object(a.a)(e,["children"]);return Object(c.jsx)(r.a,Object.assign({item:!0,xs:!0,css:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},n),t)});s.displayName="CenteredSectionItem"},305:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(289),c=n(294),r=n(9),s=n(304),i=(n(0),function(e){var t=e.title,n=e.button,i=e.children;return Object(r.jsx)(s.a,null,Object(r.jsx)(a.a,{container:!0,justify:"center",alignContent:"center",direction:"column"},Object(r.jsx)(a.a,{item:!0,css:function(e){return{marginBottom:e.spacing(3)}}},Object(r.jsx)(c.a,{component:"div",align:"center",css:function(e){return{color:e.colors.black,fontWeight:500,fontSize:e.fontSize.xLarge}}},Object(r.jsx)("span",null,t))),Object(r.jsx)(a.a,{item:!0,css:function(e){return{marginBottom:e.spacing(3)}}},Object(r.jsx)(c.a,{component:"div",align:"center",css:function(e){return{color:e.colors.secondary,fontSize:e.colors.larger}}},i)),Object(r.jsx)(a.a,{item:!0},Object(r.jsx)(a.a,{container:!0,justify:"center",alignContent:"center"},Object(r.jsx)(a.a,{item:!0},n)))))});i.displayName="EmptyList"},309:function(e,t,n){"use strict";n.r(t);var a=n(8),c=n.n(a),r=n(11),s=n(140),i=n(104),o=n(26),u=n(9),l=n(246),b=n(247),j=n(50),O=n(248),d=n(289),f=n(294),p=n(134),x=n(298),g=n(29),m=n(305),h=n(302),v=n(303),S=n(85),k=n(27),y=n.n(k),C=n(0),E=n(35),T=[{value:b.ETaskStatus.IN_PROGRESS.replace("_","-"),label:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435"},{value:b.ETaskStatus.ON_CHECK.replace("_","-"),label:"\u041d\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0435"},{value:b.ETaskStatus.EXPIRED,label:"\u041f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043d\u044b\u0435"},{value:b.ETaskStatus.DRAFT,label:"\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a\u0438"},{value:b.ETaskStatus.COMPLETED,label:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043d\u044b\u0435"}],R=[{key:"title",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u044f",sortable:!0},{key:"region",label:"\u0420\u0435\u0433\u0438\u043e\u043d",sortable:!0},{key:"city",label:"\u0424\u0438\u043b\u0438\u0430\u043b",sortable:!0},{key:"format",label:"\u0424\u043e\u0440\u043c\u0430\u0442",sortable:!0},{key:"stageTitle",label:"\u042d\u0442\u0430\u043f",sortable:!0},{key:"deadline",label:"\u0421\u0440\u043e\u043a \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f",sortable:!0}],w=function(e){var t=e["*"],n=Object(C.useContext)(S.a),a=Object(C.useState)(!1),k=Object(o.a)(a,2),w=k[0],N=k[1],D=Object(C.useState)([]),_=Object(o.a)(D,2),B=_[0],P=_[1],A=Object(C.useState)(new Map),F=Object(o.a)(A,2),L=F[0],G=F[1],M=Object(C.useState)(""),W=Object(o.a)(M,2),H=W[0],q=W[1],z=Object(C.useState)(0),K=Object(o.a)(z,2),J=K[0],U=K[1],X=Object(C.useState)(""),Q=Object(o.a)(X,2),V=Q[0],Y=Q[1],Z=Object(C.useState)(""),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(C.useState)([]),ae=Object(o.a)(ne,2),ce=ae[0],re=ae[1],se=Object(C.useState)([]),ie=Object(o.a)(se,2),oe=ie[0],ue=ie[1],le=Object(C.useState)(0),be=Object(o.a)(le,2),je=be[0],Oe=be[1],de=Object(C.useState)("asc"),fe=Object(o.a)(de,2),pe=fe[0],xe=fe[1],ge=Object(C.useState)(""),me=Object(o.a)(ge,2),he=me[0],ve=me[1],Se=Object(C.useCallback)((function(){Object(E.getAllRegions)(n.courier).then((function(e){return re(e.regions)})).catch(console.error)}),[n.courier]),ke=Object(C.useCallback)((function(e){Object(E.getCitiesForRegion)(n.courier,e).then((function(e){return ue(e.cities)})).catch(console.error)}),[n.courier]),ye=Object(C.useCallback)((function(){L.clear(),G(new Map(L))}),[L]),Ce=Object(C.useCallback)((function(e){return Object(i.a)(Object(i.a)({},e),{},{selected:!1,createdAt:Object(O.getFriendlyDate)(new Date(e.createdAt),!0),updatedAt:Object(O.getFriendlyDate)(new Date(e.updatedAt),!0),deadline:Object(O.getFriendlyDate)(new Date(e.updatedAt),!0)})}),[]),Ee=Object(C.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.sort,c=e.sortBy,r=e.title,s=e.region,i=e.city;ye();var o=(a||"ASC").toUpperCase();Object(E.getTasksExtended)(n.courier,I(t),o,c,r,s,i).then((function(e){P(e.tasks.map(Ce)),U(e.all)})).catch(console.error)}),[ye,n.courier,Ce,t]),Te=Object(C.useRef)(null);Object(C.useEffect)((function(){Te.current!==t&&(Te.current=t,Oe(0),xe("asc"),ve(""),q(""),Y(""),te(""),Ee(),Se())}),[t,Ee,Se]);var Re=Object(C.useRef)(V);Object(C.useEffect)((function(){V&&Re.current!==V&&ke(V)}),[ke,V]);var we=Object(C.useState)({redirect:!1,to:""}),Ie=Object(o.a)(we,2),Ne=Ie[0],De=Ie[1];var _e=Object(C.useCallback)((function(e,t){if(y.a.isObject(e)&&y.a.has(e,"id")){var n=y.a.get(e,"id");t?L.set(n,e):L.delete(n),G(new Map(L));var a=B.findIndex((function(e){return e.id===n}));-1!==a&&(B[a].selected=t,P(Object(s.a)(B)))}}),[L,B]),Be=Object(C.useCallback)(function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(E.updateTask)(n.courier,Number(t.id),{status:b.ETaskStatus.ON_CHECK}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n.courier]),Pe=Object(C.useCallback)((function(){var e=Object(s.a)(L.values());e.some((function(e){return e.status!==b.ETaskStatus.IN_PROGRESS}))||Promise.all(e.map(Be)).then((function(){return Ee()})).catch(console.error).finally(He)}),[L,Be,Ee]),Ae=Object(C.useCallback)(function(){var e=Object(r.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(E.updateTask)(n.courier,Number(t.id),{status:b.ETaskStatus.IN_PROGRESS}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[n.courier]),Fe=Object(C.useCallback)((function(){var e=Object(s.a)(L.values());e.some((function(e){return![b.ETaskStatus.DRAFT,b.ETaskStatus.ON_CHECK].includes(e.status)}))||Promise.all(e.map(Ae)).then((function(){return Ee()})).then((function(){return ye()})).catch(console.error)}),[ye,L,Ae,Ee]),Le=Object(C.useCallback)((function(e){var t=B.map((function(t){return Object(i.a)(Object(i.a)({},t),{},{selected:e})}));P(t),e?(t.forEach((function(e){return e.id&&L.set(e.id,e)})),G(new Map(L))):ye()}),[ye,L,B]),Ge=y.a.debounce(Ee,150),Me=Object(C.useCallback)((function(e){var t=e.target.value;q(t),Ge({title:t,region:V,city:ee,sortBy:he,sort:pe})}),[pe,he,ee,V,Ge]),We=Object(C.useCallback)((function(e,t){xe(e),ve(t),Ee({title:H,region:V,city:ee,sortBy:t,sort:e})}),[Ee,H,ee,V]);function He(){N(!1)}var qe=Object(C.useCallback)((function(e){var t=e.target.value;Y(t),te(""),t||ue([]),Ge({title:H,region:t,sort:pe,sortBy:he})}),[pe,he,H,Ge]),ze=Object(C.useCallback)((function(e){var t=e.target.value;te(t),Ge({title:H,region:V,city:t,sort:pe,sortBy:he})}),[pe,he,H,V,Ge]);var Ke=!J;return Object(u.jsx)(h.a,null,Object(u.jsx)(l.Dialog,{open:w,onClose:He,onSuccess:Pe},"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u043e\u0442\u043e\u0437\u0432\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u044f?"),Ne.redirect&&Object(u.jsx)(g.Redirect,{to:"tasks/view/".concat(Ne.to),noThrow:!0}),Object(u.jsx)(v.a,{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u0437\u0430\u0434\u0430\u043d\u0438\u0439"},Object(u.jsx)(d.a,{item:!0,hidden:Ke},Object(u.jsx)(l.Button,{component:g.Link,to:"create",variant:"contained",scheme:"blue"},Object(u.jsx)(j.AddIcon,null),Object(u.jsx)(f.a,null,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435")))),Ke&&Object(u.jsx)(m.a,{title:"\u0417\u0430\u0434\u0430\u043d\u0438\u0439 \u043d\u0435\u0442",button:Object(u.jsx)(C.Fragment,null,Object(u.jsx)(d.a,{item:!0},Object(u.jsx)(l.Button,{component:g.Link,to:"create",variant:"contained",scheme:"blue"},Object(u.jsx)(j.AddIcon,null),Object(u.jsx)(f.a,null,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"))))},Object(u.jsx)(C.Fragment,null,Object(u.jsx)("div",null,"\u0414\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u043d\u0438\u044f \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443"),Object(u.jsx)("div",null,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u043d\u0438\u0435"))),!Ke&&Object(u.jsx)(p.a,{square:!0,css:function(e){var t=e.spacing,n=e.boxShadow;return{margin:t(3),boxShadow:n.paper}}},Object(u.jsx)(d.a,{container:!0,direction:"row",css:function(e){return{padding:e.spacing(2)}}},Object(u.jsx)(d.a,{item:!0,xs:12},Object(u.jsx)(l.TabsWrapper,{tabs:T},Object(u.jsx)(d.a,{container:!0,direction:"column",css:function(e){return{padding:e.spacing(4)}}},Object(u.jsx)(d.a,{item:!0,xs:12},Object(u.jsx)(d.a,{container:!0,direction:"row",spacing:2},Object(u.jsx)(d.a,{item:!0,xs:!0},Object(u.jsx)(l.InputField,{placeholder:"\u041f\u043e\u0438\u0441\u043a ...",fullWidth:!0,value:H,onChange:Me,css:function(e){var t=e.spacing,n=e.radius,a=e.colors;return{borderRadius:n(5),background:a.white,border:"1px solid ".concat(a.lightGray),transition:"border 0.25s ease-in-out",cursor:"pointer",":hover, :active":{border:"1px solid ".concat(a.primary)},div:{":before, :after":{border:"none !important"}},input:{padding:"".concat(t(2)," ").concat(t(4))}}}})),Object(u.jsx)(d.a,{item:!0,xs:2},Object(u.jsx)(l.SelectField,{placeholderDisabled:!1,value:V,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u0435\u0433\u0438\u043e\u043d",fullWidth:!0,onChange:qe},(ce||[]).map((function(e){return Object(u.jsx)(x.a,{key:e,value:e},e)})))),Object(u.jsx)(d.a,{item:!0,xs:2},Object(u.jsx)(l.SelectField,{placeholderDisabled:!1,value:ee,placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0438\u043b\u0438\u0430\u043b",fullWidth:!0,onChange:ze},(oe||[]).map((function(e){return Object(u.jsx)(x.a,{key:e,value:e},e)})))))),Object(u.jsx)(d.a,{xs:12,item:!0,css:function(e){return{padding:e.spacing(3),paddingLeft:0,paddingRight:0}}},Object(u.jsx)(l.Table,{css:function(e){return{marginLeft:e.spacing(-2),width:"calc(100% + ".concat(e.spacing(4),")")}},page:je,order:pe,orderBy:he,selectable:!0,columns:R,data:B,onRowClick:function(e){y.a.isObject(e)&&y.a.has(e,"id")&&De({redirect:!0,to:y.a.get(e,"id")})},onRowSelectToggle:_e,onSelectToggle:Le,onRequestSort:We,onChangePage:function(e){Oe(e)}})),Object(u.jsx)(d.a,{item:!0,xs:12},(t===b.ETaskStatus.IN_PROGRESS.replace("_","-")||!t)&&Object(u.jsx)(l.Button,{variant:"contained",scheme:"blue",onClick:function(){N(!0)}},Object(u.jsx)(j.ReturnIcon,null),Object(u.jsx)(f.a,null,"\u041e\u0442\u043e\u0437\u0432\u0430\u0442\u044c")),t&&t!==b.ETaskStatus.IN_PROGRESS.replace("_","-")&&t!==b.ETaskStatus.COMPLETED&&Object(u.jsx)(l.Button,{variant:"contained",scheme:"blue",onClick:Fe},Object(u.jsx)(j.SendIcon,null),Object(u.jsx)(f.a,null,"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))))))))};function I(e){return e?e.replace("-","_"):b.ETaskStatus.IN_PROGRESS}w.displayName="TasksList",t.default=w}}]);
//# sourceMappingURL=6.930995f0.chunk.js.map